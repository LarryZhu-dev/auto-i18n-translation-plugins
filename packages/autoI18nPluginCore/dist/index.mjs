import{translate as n}from"@vitalets/google-translate-api";import e from"tunnel";import t from"axios";import r from"crypto-js";import*as o from"@babel/types";import a from"@babel/types";import i from"@babel/core";import c from"node:path";import l from"node:fs";var s=function(n,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},s(n,e)};function u(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}s(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var f=function(){return f=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},f.apply(this,arguments)};function p(n,e,t,r){return new(t||(t=Promise))((function(o,a){function i(n){try{l(r.next(n))}catch(n){a(n)}}function c(n){try{l(r.throw(n))}catch(n){a(n)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}l((r=r.apply(n,e||[])).next())}))}function g(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(n,i)}catch(n){c=[6,n],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}function h(n,e,t){if(t||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return n.concat(r||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var d,v,y,m=function(){function n(n,e,t){this.queue=[],this.isRunning=!1,this.fn=n,this.delay=e,this.timeout=t}return n.prototype.wait=function(){return p(this,arguments,void 0,(function(n){return void 0===n&&(n=this.delay),g(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){return setTimeout(e,n)}))];case 1:return e.sent(),[2]}}))}))},n.prototype.run=function(){return p(this,void 0,void 0,(function(){var n,e,t,r,o,a;return g(this,(function(i){switch(i.label){case 0:if(this.isRunning)return[2];i.label=1;case 1:if(!(n=this.queue.shift()))return[3,7];e=n.args,t=n.resolve,r=n.reject,this.isRunning=!0,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.fn.apply(this,e)];case 3:return o=i.sent(),t(o),[3,5];case 4:return a=i.sent(),r(a),[3,5];case 5:return[4,this.wait()];case 6:return i.sent(),[3,1];case 7:return this.isRunning=!1,[2]}}))}))},n.prototype.execute=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Promise((function(t,r){n.queue.push({args:e,resolve:t,reject:r}),n.run(),n.timeout&&setTimeout((function(){r(new Error("IntervalQueue timeout"))}),n.timeout)}))},n}(),b=function(){function n(n){var e=this;this.defaultErrorHandler=function(n){var t=e.option.name;console.error("翻译api".concat(t?"【".concat(t,"】"):"","请求异常：").concat(e.getErrorMessage(n)))},this.option=this.getResultOption(n)}return n.prototype.getResultOption=function(n){var e,t,r,o=f({version:1,maxChunkSize:4500,interval:0,onError:this.defaultErrorHandler},n);if(o.interval){o.fetchMethod=(e=o.fetchMethod,t=o.interval,r=new m(e.bind(null),t),function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r.execute.apply(r,n)})}return o},n.prototype.getErrorMessage=function(n){return n instanceof Error?n.message:String(n)},n.prototype.translate=function(n,e,t,r){return p(this,void 0,void 0,(function(){var o,a;return g(this,(function(i){switch(i.label){case 0:o="",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.option.fetchMethod(n,e,t,r)];case 2:return o=i.sent(),[3,4];case 3:return a=i.sent(),this.option.onError(a,this.defaultErrorHandler),[3,4];case 4:return[2,o]}}))}))},n}(),O=function(t){function r(r){var o=t.call(this,{name:"Google翻译",fetchMethod:function(t,a,i){return p(o,void 0,void 0,(function(){return g(this,(function(o){switch(o.label){case 0:return[4,n(t,f({from:a,to:i},r.proxyOption?{fetchOptions:{agent:e.httpsOverHttp({proxy:r.proxyOption})}}:{}))];case 1:return[2,o.sent().text||""]}}))}))},onError:function(n,e){e(n),n instanceof Object&&"code"in n&&"ETIMEDOUT"===n.code&&console.error("❗ 请求超时，请确保你的网络可以访问google ❗")}})||this;return o}return u(r,t),r}(b),S=function(n){function e(e){var o,a=n.call(this,{name:"有道翻译",fetchMethod:function(n,o,i){return p(a,void 0,void 0,(function(){var a,c,l,s,u,f,p;return g(this,(function(g){switch(g.label){case 0:return a=(new Date).getTime(),c=Math.round((new Date).getTime()/1e3),l=e.appId+this.truncate(n)+a+c+e.appKey,s=r.SHA256(l).toString(r.enc.Hex),u={q:n,appKey:e.appId,salt:a,from:this.getTranslateKey(o),to:this.getTranslateKey(i),sign:s,signType:"v3",curtime:c},[4,t.post("https://openapi.youdao.com/api",u,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},proxy:e.proxy})];case 1:return f=g.sent(),[2,(null===(p=f.data.translation)||void 0===p?void 0:p[0])||""]}}))}))},onError:function(n,e){e(n),console.error("请前往有道翻译官方申请翻译key，默认会有50的额度，并请检查额度是否充足。")},interval:null!==(o=e.interval)&&void 0!==o?o:1e3})||this;return a.YOUDAO_TRANSLATE_KEY_CONVERT_MAP={"zh-cn":"zh-CHS","zh-tw":"zh-CHT"},a}return u(e,n),e.prototype.truncate=function(n){if(n.length<=20)return n;var e=n.length;return n.substring(0,10)+e+n.substring(e-10)},e.prototype.getTranslateKey=function(n){return this.YOUDAO_TRANSLATE_KEY_CONVERT_MAP[n]||n},e}(b),E=function(n){function e(e){var o,a=n.call(this,{name:"百度翻译",fetchMethod:function(n,o,i,c){return p(a,void 0,void 0,(function(){var a,l,s,u,f;return g(this,(function(p){switch(p.label){case 0:return a=(new Date).getTime(),l={q:n,appid:e.appId,from:this.getTranslateKey(o),to:this.getTranslateKey(i),salt:a,sign:r.MD5(e.appId+n+a+e.appKey).toString()},[4,t.post("https://fanyi-api.baidu.com/api/trans/vip/translate",l,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},proxy:e.proxy})];case 1:return s=p.sent(),u=null===(f=s.data)||void 0===f?void 0:f.trans_result.map((function(n){return n.dst})).filter((function(n,e){return e%2==0})).join(c),[2,u||""]}}))}))},onError:function(n,e){e(n),console.error("请前往百度翻译官方申请翻译key，每个月都有免费额度，并请检查额度是否充足。")},interval:null!==(o=e.interval)&&void 0!==o?o:1e3})||this;return a.BAIDU_TRANSLATE_KEY_CONVERT_MAP={"zh-cn":"zh",ja:"jp",ko:"kor"},a}return u(e,n),e.prototype.getTranslateKey=function(n){return this.BAIDU_TRANSLATE_KEY_CONVERT_MAP[n]||n},e}(b),x=function(n){function e(e){void 0===e&&(e={});var t=this,r=f({name:"空翻译器",fetchMethod:function(n,e,r,o){return p(t,void 0,void 0,(function(){return g(this,(function(e){return[2,n.split(o).fill("").join(o)]}))}))}},e);return t=n.call(this,r)||this}return u(e,n),e}(b),T=x,w=function(n){function e(e){var r,o=n.call(this,{name:"火山引擎ai翻译",fetchMethod:function(n,r,a,i){return p(o,void 0,void 0,(function(){var o,c,l,s;return g(this,(function(u){switch(u.label){case 0:return o=(new Date).getTime(),c=n.split(i),l={model:e.model,messages:[{role:"system",content:"首先，你是一个专业的翻译助手。有一个web项目，".concat(e.desc?"它的开发者是这么描述它的：".concat(e.desc,"。"):"","现在我将这个项目中所使用的web抽成一个文本数组。你需要请将数组的每个成员从原语言").concat(r,"翻译成目标语言").concat(a,"，并直接返回翻译后的文本数组，不要包含任何解释。")},{role:"user",content:JSON.stringify(c)}]},[4,t.post("https://ark.cn-beijing.volces.com/api/v3/chat/completions?t=".concat(o),l,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.apiKey)},proxy:e.proxy})];case 1:s=u.sent();try{return[2,JSON.parse(s.data.choices[0].message.content).join(i)]}catch(e){return console.error("🚀 ~ VolcengineTranslator ~ fetchMethod: ~ error:",e),[2,n]}return[2]}}))}))},onError:function(n,e){e(n),console.error("请确保在火山引擎控制台开通了对应模型，且有足够的token余额。控制台地址：https://console.volcengine.com/ark/")},maxChunkSize:1e4,interval:null!==(r=e.interval)&&void 0!==r?r:1e3})||this;return o}return u(e,n),e}(b);!function(n){n.ZH="zh-cn",n.EN="en",n.JA="ja",n.KO="ko",n.RU="ru"}(d||(d={})),function(n){n.google="Google",n.youdao="Youdao"}(v||(v={})),function(n){n.FULL_AUTO="full-auto",n.SEMI_AUTO="semi-auto"}(y||(y={}));var j,L=function(){function n(){}return n.originLang="",n}(),k=((j={})[d.ZH]=/[\u4e00-\u9fff]/,j[d.EN]=/[a-zA-Z]/,j[d.JA]=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF]/,j[d.KO]=/[\uAC00-\uD7A3]/,j[d.RU]=/[йцукенгшщзхъфывапролджэячсмитьбюё .-]{1,}/,j);function _(){var n=L.originLang;return k[n]}function A(n){return _().test(n)}function C(n,e){for(var t=0;t<e.length;t++){if(("string"==typeof e[t]?new RegExp(e[t]):e[t]).test(n))return!0}return!1}function N(n){var e="";return a.isCallExpression(n)&&(e=a.isMemberExpression(n.callee)?function n(e,t){return t+="."+e.property.name,a.isMemberExpression(e.object)?n(e.object,t):t=e.object.name+t}(n.callee,""):n.callee.name||""),e}function K(n,e){var t=n.match(e);return t?t.filter((function(n,e){return t.indexOf(n)===e})):[]}function P(n){var e=n.value,t=n.isExpression,r=void 0!==t&&t,o=n.key,i=n.insertOption,c=U.namespace,l=e.trim(),s=l.replace(/'/g,'"').replace(/(\n)/g,"\\n"),u=o||J(s),f={option:U,hash:u,value:l,uncodeValue:s,namespace:c};if(U.translateExtends){var p=U.translateExtends,g=p.handleCodeCall,h=p.handleCodeString;return r?g(f,i):h(f,i)}if(r){var d=a.stringLiteral(l);return d.extra={raw:"'".concat(s,"'"),rawValue:l},a.callExpression(a.identifier(U.translateKey),[a.stringLiteral(u),d,a.stringLiteral(c)])}return"".concat(U.translateKey,"('").concat(u,"','").concat(s,"','").concat(c,"')")}function J(n){for(var e=0,t=0;t<n.length;t++){e=(e<<5)-e+n.charCodeAt(t),e|=0}return Math.abs(e).toString(36)+n.length.toString(36)}var F=function(n){return n.replace(/\\u[\dA-Fa-f]{4}/g,(function(n){return String.fromCharCode(parseInt(n.replace(/\\u/g,""),16))}))};function I(n,e){if(void 0===e&&(e=new WeakMap),"object"!=typeof n||null===n)return n;if(e.has(n))return e.get(n);if(n instanceof Date)return new Date(n);if(n instanceof RegExp)return new RegExp(n.source,n.flags);var t=Array.isArray(n)?[]:{};e.set(n,t);for(var r=0,o=h(h([],Object.keys(n),!0),Object.getOwnPropertySymbols(n).filter((function(e){return n.propertyIsEnumerable(e)})),!0);r<o.length;r++){var a=o[r];t[a]=I(n[a],e)}return t}var M=Object.freeze({__proto__:null,checkAgainstRegexArray:C,cloneDeep:I,createI18nTranslator:P,extractCnStrings:function(n){return K(n,/[^\x00-\xff]+/g)},extractFunctionName:N,extractStrings:K,generateId:J,getOriginRegex:_,hasOriginSymbols:A,removeComments:function(n){return n=(n=(n=n.replace(/\/\/.*?\n/g,"")).replace(/\/\*[\s\S]*?\*\//g,"")).replace(/<!--[\s\S]*?-->/g,"")},truncate:function(n){if(n.length<=20)return n;var e=n.length;return n.substring(0,10)+e+n.substring(e-10)},unicodeToString:F}),R=["$deepScan","console.info","console.warn","console.error","$i8n","console.log","$t","require","$$i8n","$$t","_createCommentVNode"],D={translateKey:"$t",excludedCall:[],excludedPattern:[/\.\w+$/],excludedPath:["node_modules"],includePath:[/src\//,/src\\/],globalPath:"./lang",distPath:"",distKey:"index",originLang:d.ZH,targetLangList:["en"],langKey:[],namespace:"lang",buildToDist:!1,translator:new O({proxyOption:{port:7890,host:"127.0.0.1",headers:{"User-Agent":"Node"}}}),translatorOption:void 0,translateType:y.FULL_AUTO,rewriteConfig:!0,commonTranslateKey:"",deepScan:!1,insertFileExtensions:[],translateExtends:null},U=f({},D);function z(n){U=f(f({},D),function(n){var e=I(n);return e.translator=null==n?void 0:n.translator,e.translator||(e.translator=e.translatorOption?new b(e.translatorOption):void 0),e.translator||delete e.translator,e}(n)),U.langKey=h([U.originLang],U.targetLangList,!0),U.excludedCall=h(h(h([],U.excludedCall,!0),R,!0),[U.translateKey,"$"+U.translateKey],!1)}function $(){return U.translateKey?U.namespace?U.buildToDist&&!U.distKey?(console.log("❌请配置打包后生成文件的主文件名称"),!1):U.buildToDist&&!U.distPath?(console.log("❌请配置打包后生成文件的位置"),!1):U.originLang?!(!U.targetLangList||!U.targetLangList.length)||(console.error("❌请配置目标翻译语言数组"),!1):(console.error("❌请配置来源语言"),!1):(console.error("❌请配置命名空间"),!1):(console.error("❌请配置翻译调用函数"),!1)}var V=function(){var n=this;this.handleInitFile=function(e,t){return p(n,void 0,void 0,(function(){var n,r,o,c,l;return g(this,(function(s){switch(s.label){case 0:return n=e,r=!1,o=!1,c="Vue",[4,i.transformAsync(n,{configFile:!1,plugins:[{visitor:{ImportDeclaration:function(n){var e=n.node;if("vue"===e.source.value){r=!0;var t=e.specifiers;t.forEach((function(n){a.isImportDefaultSpecifier(n)&&(o=!0,c=n.local.name)})),o||(o=!0,t.unshift(a.importDefaultSpecifier(a.identifier("Vue"))))}}}}]})];case 1:return l=s.sent(),r&&l&&(n=l.code),r||(n="import Vue from 'vue'\n                                    ".concat(n)),[2,{path:t,importDefaultChar:c,source:n}]}}))}))},this.handleCodeCall=function(n,e){var t=n.option,r=n.hash,o=n.value,i=n.uncodeValue,c=n.namespace,l=a.stringLiteral(o);return l.extra={raw:"'".concat(i,"'"),rawValue:o},a.callExpression(a.memberExpression(a.memberExpression(a.identifier(e.importDefaultChar),a.identifier("prototype")),a.identifier(t.translateKey)),[a.stringLiteral(r),l,a.stringLiteral(c)])},this.handleCodeString=function(n,e){var t=n.option,r=n.hash,o=n.uncodeValue,a=n.namespace;return"".concat(e.importDefaultChar,".prototype.").concat(t.translateKey,"('").concat(r,"','").concat(o,"','").concat(a,"')")}},H={tab:{char:"\t",size:1},space:{char:" ",size:4}},W={type:"tab"},B=[],Y=function(n){return"\\".concat(B.push(n),"\\")},q=function(n,e){return B[+e-1]},X=function(n,e){return new Array(n+1).join(e)};function G(n,e){void 0===e&&(e=W);var t="string"==typeof n?n:JSON.stringify(n),r=H[e.type];if(!r)throw new Error('Unrecognized indent type: "'.concat(e.type,'"'));return function(n,e){B=[];var t="",r=0;n=n.replace(/\\./g,Y).replace(/(".*?"|'.*?')/g,Y).replace(/\s+/g,"");for(var o=0;o<n.length;o++){var a=n.charAt(o);switch(a){case"{":case"[":t+=a+"\n"+X(++r,e);break;case"}":case"]":t+="\n"+X(--r,e)+a;break;case",":t+=",\n"+X(r,e);break;case":":t+=": ";break;default:t+=a}}return t.replace(/\[[\d,\s]+?\]/g,(function(n){return n.replace(/\s/g,"")})).replace(/\\(\d+)\\/g,q).replace(/\\(\d+)\\/g,q)}(t,X(e.size||r.size,r.char))}function Z(){var n=U.translateKey,e=U.namespace,t=U.originLang,r=U.targetLangList,o=U.commonTranslateKey,a=h(h([],r,!0),[t],!1).map((function(n){return[n.replace("-",""),n]})).map((function(n){return"'".concat(n[0],"': (globalThis && globalThis.").concat(e," && globalThis.").concat(e,".").concat(n[0],") ? globalThis.").concat(e,".").concat(n[0]," : globalThis._getJSONKey('").concat(n[1],"', langJSON)")})).join(",\n"),i="\n    // 导入国际化JSON文件\n    import langJSON from './index.json'\n    (function () {\n    // 定义翻译函数\n    let ".concat(n," = function (key, val, nameSpace) {\n      // 获取指定命名空间下的语言包\n      const langPackage = ").concat(n,"[nameSpace];\n      // 返回翻译结果，如果不存在则返回默认值\n      return (langPackage || {})[key] || val;\n    };\n    // 定义简单翻译函数，直接返回传入的值\n    let $").concat(n," = function (val) {\n      return val;\n    };\n    globalThis.$deepScan = function (val) {\n      return val;\n    };\n    // 定义设置语言包的方法\n    ").concat(n,".locale = function (locale, nameSpace) {\n      // 将指定命名空间下的语言包设置为传入的locale\n      ").concat(n,"[nameSpace] = locale || {};\n    };\n    // 将翻译函数挂载到globalThis对象上，如果已经存在则使用已有的\n    globalThis.").concat(n," = globalThis.").concat(n," || ").concat(n,";\n    // 将简单翻译函数挂载到globalThis对象上\n    globalThis.$").concat(n," = $").concat(n,";\n    // 定义从JSON文件中获取指定键的语言对象的方法\n    globalThis._getJSONKey = function (key, insertJSONObj = undefined) {\n        // 获取JSON对象\n        const JSONObj = insertJSONObj;\n        // 初始化语言对象\n        const langObj = {};\n        // 遍历JSON对象的所有键\n        Object.keys(JSONObj).forEach((value) => {\n            // 将每个语言的对应键值添加到语言对象中\n            langObj[value] = JSONObj[value][key];\n        });\n        // 返回语言对象\n        return langObj;\n    };\n    })();\n    // 定义语言映射对象\n    const langMap = {\n        ").concat(a,"\n    };\n    // 存储语言是否存在\n    // 判断 globalThis.localStorage.getItem 是否为函数\n    const isFunction = (fn) => {\n        return typeof fn === 'function';\n    };\n    const withStorageLang = isFunction && globalThis && globalThis.localStorage && \n    isFunction(globalThis.localStorage.getItem) && globalThis.localStorage.getItem('").concat(e,"');\n    const withStorageCommonLang = isFunction && globalThis && globalThis.localStorage && \n    isFunction(globalThis.localStorage.getItem) && globalThis.localStorage.getItem('").concat(o,"');\n    // 从本地存储中获取通用语言，如果不存在则使用空字符串\n    const commonLang = withStorageCommonLang ? globalThis.localStorage.getItem('").concat(o,"') : '';\n    // 从本地存储中获取当前语言，如果不存在则使用源语言\n    const baseLang = withStorageLang ? globalThis.localStorage.getItem('").concat(e,"') : '").concat(t.replace("-",""),"';\n    const lang = commonLang ? commonLang : baseLang;\n    // 根据当前语言设置翻译函数的语言包\n    globalThis.").concat(n,".locale(langMap[lang], '").concat(e,"');\n  "),s=c.join(U.globalPath,"index.js");if(!l.existsSync(s)||U.rewriteConfig){var u=!0;if(l.existsSync(s))u=J(i)!==J(l.readFileSync(s,"utf-8"));u&&l.writeFileSync(s,i)}}function Q(){var n=c.join(U.globalPath,"index.json");l.existsSync(n)||l.writeFileSync(n,JSON.stringify({}))}function nn(){var n=c.join(U.globalPath,"index.json");try{return l.readFileSync(n,"utf-8")}catch(n){return"ENOENT"===n.code?console.log("❌读取JSON配置文件异常，文件不存在"):console.log("❌读取JSON配置文件异常，无法读取文件"),JSON.stringify({})}}function en(n,e){void 0===e&&(e=void 0);var t=e||JSON.parse(nn()),r={};return Object.keys(t).forEach((function(e){r[e]=t[e][n]})),r}function tn(n){var e=c.join(U.globalPath,"index.json"),t=G(n);l.existsSync(e)?l.writeFileSync(e,t):console.log("❌JSON配置文件写入异常，文件不存在")}var rn=Object.freeze({__proto__:null,buildSetLangConfigToIndexFile:function(){if(U.buildToDist){var n={};U.langKey.forEach((function(e){n[e]=en(e)})),l.existsSync(U.distPath)&&l.readdir(U.distPath,(function(e,t){e?console.error("❌构建文件夹为空，翻译配置无法写入"):t.forEach((function(e){if(e.startsWith(U.distKey)&&e.endsWith(".js")){var t=c.join(U.distPath,e);l.readFile(t,"utf-8",(function(e,r){if(e)return console.log(t),void console.error("❌构建主文件不存在，翻译配置无法写入");var o="";Object.keys(n).forEach((function(e){o+="globalThis['".concat(U.namespace,"']['").concat(e,"']=").concat(JSON.stringify(n[e]),";")}));try{l.writeFileSync(t,"globalThis['".concat(U.namespace,"']={};").concat(o)+r),console.info("恭喜：翻译配置写入构建主文件成功🌟🌟🌟")}catch(e){console.error("翻译配置写入构建主文件失败:",e)}}))}}))}))}},getLangObjByJSONFileWithLangKey:en,getLangTranslateJSONFile:nn,initLangFile:function(){l.existsSync(U.globalPath)||l.mkdirSync(U.globalPath),Q(),Z()},initLangTranslateJSONFile:Q,initTranslateBasicFnFile:Z,setLangTranslateJSONFile:tn}),on="\n┇┇┇\n",an=/\n┇ *┇ *┇\n/,cn={};function ln(n,e){cn[n]||(cn[n]=e)}function sn(){return cn}function un(n,e,t){return p(this,void 0,void 0,(function(){var r,o,a,i;return g(this,(function(c){switch(c.label){case 0:return r={},Object.keys(n).forEach((function(t){e[t]||(r[t]=n[t])})),Object.values(r).length?(console.info("进入新增语言补全翻译..."),[4,fn(r,t)]):[2];case 1:if((o=c.sent()).length!==Object.values(n).length)return console.error("翻译异常，翻译结果缺失❌"),[2];a=o,console.info("翻译成功⭐️⭐️⭐️"),Object.keys(r).forEach((function(n,t){e[n]=a[t]})),console.log("开始写入JSON配置文件..."),i=JSON.parse(nn()),Object.keys(r).forEach((function(n){i[n][t]=e[n]}));try{tn(i),console.info("JSON配置文件写入成功⭐️⭐️⭐️")}catch(n){console.error("❌JSON配置文件写入失败"+n)}return console.info("新增语言翻译补全成功⭐️⭐️⭐️"),[2]}}))}))}function fn(n,e){return p(this,void 0,void 0,(function(){var t,r,o,a;return g(this,(function(i){switch(i.label){case 0:for(t=U.translator,r=function(n,e){for(var t=on.length,r=[],o=[],a=0,i=function(){if(o.length>0){var n=o.join(on).length;n>e&&console.warn("缓冲区提交异常：生成块长度 ".concat(n," 超过限制")),r.push(o.join(on)),o=[],a=0}},c=0,l=n;c<l.length;c++){var s=l[c],u=s.length+(o.length>0?t:0);s.length>e?(o.length>0&&i(),s.length>1.5*e&&console.warn("超长文本告警：检测到长度 ".concat(s.length," 字符的文本项，可能影响翻译质量")),r.push(s)):(a+u>e&&i(),a+=u,o.push(s))}return i(),r}(Object.values(n),t.option.maxChunkSize),o=[],a=0;a<r.length;a++)o.push(t.translate(r[a],U.originLang,e,on));return[4,Promise.all(o)];case 1:return[2,i.sent().map((function(n){var e=function(n,e){return n.split(e).map((function(n){return n.trim()}))};if(an.test(n))return e(n,an);var t=n.split("\n").find((function(n){return 3===n.length})),r=[];t&&(r=e(n,new RegExp("\\n".concat(t,"\\n"))));var o=r.filter(Boolean);return o.length>1?o:e(n,an)})).flat()]}}))}))}var pn=Object.freeze({__proto__:null,SEPARATOR:on,SPLIT_SEPARATOR_REGEX:an,autoTranslate:function(){return p(this,void 0,void 0,(function(){var n,e,t,r,o,a,i,c;return g(this,(function(l){switch(l.label){case 0:if(n={},U.langKey.forEach((function(e){n[e]=en(e)})),e=JSON.parse(JSON.stringify(sn())),t={},Object.keys(e).forEach((function(r){n[U.originLang][r]||(t[r]=e[r])})),0===Object.keys(t).length)return console.info("✅ 当前没有需要翻译的新内容"),[2];r={},o=0,l.label=1;case 1:return o<U.langKey.length?(a=U.langKey[o],0===o?(r[U.originLang]=Object.values(t),[3,3]):(console.info("开始自动翻译..."),[4,fn(t,U.langKey[o])])):[3,4];case 2:if((i=l.sent()).length!==Object.keys(t).length)return console.error("❌ 使用付费翻译时，请检查翻译API额度是否充足，或是否已申请对应翻译API使用权限"),console.error("❌ 翻译结果不完整\n                预期数量: ".concat(Object.keys(t).length,"\n                实际数量: ").concat(i.length,"\n                样例数据: ").concat(JSON.stringify(i.slice(0,3)))),[2];r[a]=i,console.info("✅ ".concat(a," 翻译完成")),l.label=3;case 3:return o++,[3,1];case 4:Object.keys(t).forEach((function(e,t){U.langKey.forEach((function(o){n[o][e]=r[o][t]}))})),console.log("📄 构建配置文件数据结构..."),c={},Object.keys(n[U.originLang]).forEach((function(e){c[e]={},U.langKey.forEach((function(t){c[e][t]=n[t][e]}))}));try{tn(c),console.info("🎉 多语言配置文件已成功更新")}catch(n){console.error("❌ 配置文件写入失败，原因:",n)}return[2]}}))}))},completionTranslateAndWriteConfigFile:un,getLangObj:sn,initLangObj:function(n){Object.keys(cn)||(cn=n)},get langObj(){return cn},languageConfigCompletion:function(n){var e=this;if(Object.keys(n)){var t=[],r=JSON.parse(nn());U.targetLangList.forEach((function(n){var e=en(n,r);t.push({key:n,curLangObj:e})})),t.forEach((function(t){return p(e,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return[4,un(n,t.curLangObj,t.key)];case 1:return e.sent(),[2]}}))}))}))}},setLangObj:ln});function gn(n){var e=n.arguments||[],t=o.isStringLiteral(e[0])?e[0].value:"",r=o.isStringLiteral(e[1])?e[1].value:"";t&&r&&o.isStringLiteral(e[1])&&ln(t,r)}function hn(n){return function(e){var t,r,a,i;if(U.translateType!==y.SEMI_AUTO){var c,l=e.node,s=e.parent,u=l.value;if(["zh-cn","ja","ko"].some((function(n){return U.originLang.includes(n)||U.originLang===n})))try{u=F(u)}catch(n){console.log("转换异常")}if(A(u)&&U.excludedPattern.length&&!C(u,h([],U.excludedPattern,!0))){var f=N(s);if((null===(r=null===(t=null==s?void 0:s.callee)||void 0===t?void 0:t.property)||void 0===r?void 0:r.name)===U.translateKey||o.isImportDeclaration(s)||s.key===l||o.isCallExpression(s)&&f&&(U.excludedCall.includes(f)||(null===(a=null==f?void 0:f.split("."))||void 0===a?void 0:a.pop())&&U.excludedCall.includes((null===(i=null==f?void 0:f.split("."))||void 0===i?void 0:i.pop())||"")))return;var p=void 0;if(U.deepScan&&((c=u).includes("\n")||c.includes("\\")||c.includes("\r")||c.includes("\t")||c.includes("\v")||c.includes("\f")||c.includes(">")||c.includes("<")))p=function(n,e){var t=[],r=[];n.forEach((function(n,a){0===a?_().test(n)?(t.push(o.templateElement({raw:"",cooked:""},!1)),r.push(P({value:n,isExpression:!0,insertOption:e}))):t.push(o.templateElement({raw:n,cooked:n},!1)):_().test(n)?r.push(P({value:n,isExpression:!0,insertOption:e})):t.push(o.templateElement({raw:n,cooked:n},!1))})),t.length===r.length?t.push(o.templateElement({raw:"",cooked:""},!0)):t.length>r.length&&(t[t.length-1].tail=!0);var a=o.templateLiteral(t,r);return o.callExpression(o.identifier("$deepScan"),[a])}(function(n,e){for(var t=new RegExp("(".concat(e.source,"|").concat(/[，。？！《》,.．：!?""''；‘“、0-9]/.source,")"),e.flags),r=n.split(t).filter(Boolean),o=[],a="",i=new RegExp("(".concat(e.source,"|").concat(/[，。？！《》,.．：!?；‘“、0-9]/.source,")"),e.flags),c=0,l=r;c<l.length;c++){var s=l[c];i.test(s)?a+=s:(a&&(o.push(a),a=""),o.push(s))}a&&o.push(a);for(var u=[],f="",p=0;p<o.length;p++)s=o[p],e.test(s)?(f&&(u.push(f),f=""),u.push(s)):(f+=s,(p===o.length-1||e.test(o[p+1]))&&(u.push(f),f=""));return f&&u.push(f),u}(u,_()),n);else if(o.isJSXAttribute(s)){var g=P({insertOption:n,value:u,isExpression:!0});p=o.jSXExpressionContainer(g)}else p=P({insertOption:n,value:u,isExpression:!0});e.replaceWith(p)}}}}var dn=Object.freeze({__proto__:null,default:function(n){var e=hn(n),t=function(n){return function(e){if(console.log("jsx text"),U.translateType!==y.SEMI_AUTO){var t=e.node.value;if(["zh-cn","ja","ko"].some((function(n){return U.originLang.includes(n)||U.originLang===n})))try{t=F(t)}catch(n){console.log("转换异常")}if(A(t)&&U.excludedPattern.length&&!C(t,h([],U.excludedPattern,!0))){var r=P({insertOption:n,value:t,isExpression:!0}),a=o.jSXExpressionContainer(r);e.replaceWith(a)}}}}(n),r=function(n){return function(e){var t,r;if(U.translateType!==y.SEMI_AUTO){var o=e.node,i=e.parent;if(o.value){var c=o.value.raw||o.value.cooked;if(["zh-cn","ja","ko"].some((function(n){return U.originLang.includes(n)||U.originLang===n})))try{c=F(c)}catch(n){console.log("转换异常")}if(c&&A(c)&&U.excludedPattern.length&&!C(c,h([],U.excludedPattern,!0))){var l=N(i);if(a.isCallExpression(i)&&l&&(U.excludedCall.includes(l)||(null===(t=null==l?void 0:l.split("."))||void 0===t?void 0:t.pop())&&U.excludedCall.includes((null===(r=null==l?void 0:l.split("."))||void 0===r?void 0:r.pop())||"")))return;var s=P({insertOption:n,value:c});o.value.raw=o.value.cooked="${".concat(s,"}");var u=J(c);u&&c&&ln(u,c)}}}}}(n),i=function(n){return function(e){var t,r=e.node,o=r.callee;if(o.name===U.translateKey||o.property&&o.property.name===U.translateKey)if(U.translateType===y.SEMI_AUTO){var a=r.arguments||[];if(1===a.length){var i=(null===(t=a[0])||void 0===t?void 0:t.value)||"",c=P({insertOption:n,value:i,isExpression:!0});e.replaceWith(c),gn(c)}}else U.translateType===y.FULL_AUTO&&(o.name===U.translateKey||o.property&&o.property.name===U.translateKey)&&gn(r)}}(n);return function(){return{visitor:{StringLiteral:e,JSXText:t,TemplateElement:r,CallExpression:i}}}}});export{E as BaiduTranslator,x as EmptyTranslator,L as FunctionFactoryOption,O as GoogleTranslator,T as ScanTranslator,b as Translator,w as VolcengineTranslator,V as Vue2Extends,S as YoudaoTranslator,M as baseUtils,$ as checkOption,rn as fileUtils,dn as filter,z as initOption,U as option,pn as translateUtils};
//# sourceMappingURL=index.mjs.map
