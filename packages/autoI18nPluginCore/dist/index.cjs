"use strict";var t=require("@vitalets/google-translate-api"),n=require("tunnel"),e=require("axios"),o=require("crypto-js"),r=require("@babel/types"),i=require("@babel/core"),a=require("node:path"),s=require("node:fs");function c(t){var n=Object.create(null);return t&&Object.keys(t).forEach((function(e){if("default"!==e){var o=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,o.get?o:{enumerable:!0,get:function(){return t[e]}})}})),n.default=t,Object.freeze(n)}var l=c(r),u=function(t,n){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},u(t,n)};function p(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var f=function(){return f=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},f.apply(this,arguments)};function g(t,n,e,o){return new(e||(e=Promise))((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}c((o=o.apply(t,n||[])).next())}))}function h(t,n){var e,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(e=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(t,a)}catch(t){s=[6,t],o=0}finally{e=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function d(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}"function"==typeof SuppressedError&&SuppressedError;var v,y,x,b=function(){function t(t,n,e){this.queue=[],this.isRunning=!1,this.fn=t,this.delay=n,this.timeout=e}return t.prototype.wait=function(){return g(this,arguments,void 0,(function(t){return void 0===t&&(t=this.delay),h(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){return setTimeout(n,t)}))];case 1:return n.sent(),[2]}}))}))},t.prototype.run=function(){return g(this,void 0,void 0,(function(){var t,n,e,o,r,i;return h(this,(function(a){switch(a.label){case 0:if(this.isRunning)return[2];a.label=1;case 1:if(!(t=this.queue.shift()))return[3,7];n=t.args,e=t.resolve,o=t.reject,this.isRunning=!0,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fn.apply(this,n)];case 3:return r=a.sent(),e(r),[3,5];case 4:return i=a.sent(),o(i),[3,5];case 5:return[4,this.wait()];case 6:return a.sent(),[3,1];case 7:return this.isRunning=!1,[2]}}))}))},t.prototype.execute=function(){for(var t=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new Promise((function(e,o){t.queue.push({args:n,resolve:e,reject:o}),t.run(),t.timeout&&setTimeout((function(){o(new Error("IntervalQueue timeout"))}),t.timeout)}))},t}(),m=function(){function t(t){var n=this;this.defaultErrorHandler=function(t){var e=n.option.name;console.error("翻译api".concat(e?"【".concat(e,"】"):"","请求异常：").concat(n.getErrorMessage(t)))},this.option=this.getResultOption(t)}return t.prototype.getResultOption=function(t){var n,e,o,r=f({version:1,maxChunkSize:4500,interval:0,onError:this.defaultErrorHandler},t);if(r.interval){r.fetchMethod=(n=r.fetchMethod,e=r.interval,o=new b(n.bind(null),e),function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.execute.apply(o,t)})}return r},t.prototype.getErrorMessage=function(t){return t instanceof Error?t.message:String(t)},t.prototype.translate=function(t,n,e,o){return g(this,void 0,void 0,(function(){var r,i;return h(this,(function(a){switch(a.label){case 0:r="",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.option.fetchMethod(t,n,e,o)];case 2:return r=a.sent(),[3,4];case 3:return i=a.sent(),this.option.onError(i,this.defaultErrorHandler),[3,4];case 4:return[2,r]}}))}))},t}(),O=function(e){function o(o){var r=e.call(this,{name:"Google翻译",fetchMethod:function(e,i,a){return g(r,void 0,void 0,(function(){return h(this,(function(r){switch(r.label){case 0:return[4,t.translate(e,f({from:i,to:a},o.proxyOption?{fetchOptions:{agent:n.httpsOverHttp({proxy:o.proxyOption})}}:{}))];case 1:return[2,r.sent().text||""]}}))}))},onError:function(t,n){n(t),t instanceof Object&&"code"in t&&"ETIMEDOUT"===t.code&&console.error("❗ 请求超时，请确保你的网络可以访问google ❗")}})||this;return r}return p(o,e),o}(m),S=function(t){function n(n){var r,i=t.call(this,{name:"有道翻译",fetchMethod:function(t,r,a){return g(i,void 0,void 0,(function(){var i,s,c,l,u,p,f;return h(this,(function(g){switch(g.label){case 0:return i=(new Date).getTime(),s=Math.round((new Date).getTime()/1e3),c=n.appId+this.truncate(t)+i+s+n.appKey,l=o.SHA256(c).toString(o.enc.Hex),u={q:t,appKey:n.appId,salt:i,from:this.getTranslateKey(r),to:this.getTranslateKey(a),sign:l,signType:"v3",curtime:s},[4,e.post("https://openapi.youdao.com/api",u,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},proxy:n.proxy})];case 1:return p=g.sent(),[2,(null===(f=p.data.translation)||void 0===f?void 0:f[0])||""]}}))}))},onError:function(t,n){n(t),console.error("请前往有道翻译官方申请翻译key，默认会有50的额度，并请检查额度是否充足。")},interval:null!==(r=n.interval)&&void 0!==r?r:1e3})||this;return i.YOUDAO_TRANSLATE_KEY_CONVERT_MAP={"zh-cn":"zh-CHS","zh-tw":"zh-CHT"},i}return p(n,t),n.prototype.truncate=function(t){if(t.length<=20)return t;var n=t.length;return t.substring(0,10)+n+t.substring(n-10)},n.prototype.getTranslateKey=function(t){return this.YOUDAO_TRANSLATE_KEY_CONVERT_MAP[t]||t},n}(m),T=function(t){function n(n){var r,i=t.call(this,{name:"百度翻译",fetchMethod:function(t,r,a,s){return g(i,void 0,void 0,(function(){var i,c,l,u,p;return h(this,(function(f){switch(f.label){case 0:return i=(new Date).getTime(),c={q:t,appid:n.appId,from:this.getTranslateKey(r),to:this.getTranslateKey(a),salt:i,sign:o.MD5(n.appId+t+i+n.appKey).toString()},[4,e.post("https://fanyi-api.baidu.com/api/trans/vip/translate",c,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},proxy:n.proxy})];case 1:return l=f.sent(),u=null===(p=l.data)||void 0===p?void 0:p.trans_result.map((function(t){return t.dst})).filter((function(t,n){return n%2==0})).join(s),[2,u||""]}}))}))},onError:function(t,n){n(t),console.error("请前往百度翻译官方申请翻译key，每个月都有免费额度，并请检查额度是否充足。")},interval:null!==(r=n.interval)&&void 0!==r?r:1e3})||this;return i.BAIDU_TRANSLATE_KEY_CONVERT_MAP={"zh-cn":"zh",ja:"jp",ko:"kor"},i}return p(n,t),n.prototype.getTranslateKey=function(t){return this.BAIDU_TRANSLATE_KEY_CONVERT_MAP[t]||t},n}(m),E=function(t){function n(n){void 0===n&&(n={});var e=this,o=f({name:"空翻译器",fetchMethod:function(t,n,o,r){return g(e,void 0,void 0,(function(){return h(this,(function(n){return[2,t.split(r).fill("").join(r)]}))}))}},n);return e=t.call(this,o)||this}return p(n,t),n}(m),j=E,w=function(t){function n(n){var o,r=t.call(this,{name:"火山引擎ai翻译",fetchMethod:function(t,o,i,a){return g(r,void 0,void 0,(function(){var r,s,c,l;return h(this,(function(u){switch(u.label){case 0:return r=(new Date).getTime(),s=t.split(a),c={model:n.model,messages:[{role:"system",content:"首先，你是一个专业的翻译助手。有一个web项目，".concat(n.desc?"它的开发者是这么描述它的：".concat(n.desc,"。"):"","现在我将这个项目中所使用的web抽成一个文本数组。你需要请将数组的每个成员从原语言").concat(o,"翻译成目标语言").concat(i,"，并直接返回翻译后的文本数组，不要包含任何解释。")},{role:"user",content:JSON.stringify(s)}]},[4,e.post("https://ark.cn-beijing.volces.com/api/v3/chat/completions?t=".concat(r),c,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.apiKey)},proxy:n.proxy})];case 1:l=u.sent();try{return[2,JSON.parse(l.data.choices[0].message.content).join(a)]}catch(n){return console.error("🚀 ~ VolcengineTranslator ~ fetchMethod: ~ error:",n),[2,t]}return[2]}}))}))},onError:function(t,n){n(t),console.error("请确保在火山引擎控制台开通了对应模型，且有足够的token余额。控制台地址：https://console.volcengine.com/ark/")},maxChunkSize:1e4,interval:null!==(o=n.interval)&&void 0!==o?o:1e3})||this;return r}return p(n,t),n}(m);!function(t){t.ZH="zh-cn",t.EN="en",t.JA="ja",t.KO="ko",t.RU="ru"}(v||(v={})),function(t){t.google="Google",t.youdao="Youdao"}(y||(y={})),function(t){t.FULL_AUTO="full-auto",t.SEMI_AUTO="semi-auto"}(x||(x={}));var L,k=function(){function t(){}return t.originLang="",t}(),_=((L={})[v.ZH]=/[\u4e00-\u9fff]/,L[v.EN]=/[a-zA-Z]/,L[v.JA]=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF]/,L[v.KO]=/[\uAC00-\uD7A3]/,L[v.RU]=/[йцукенгшщзхъфывапролджэячсмитьбюё .-]{1,}/,L);function A(){var t=k.originLang;return _[t]}function C(t){return A().test(t)}function N(t,n){for(var e=0;e<n.length;e++){if(("string"==typeof n[e]?new RegExp(n[e]):n[e]).test(t))return!0}return!1}function K(t){var n="";return r.isCallExpression(t)&&(n=r.isMemberExpression(t.callee)?function t(n,e){return e+="."+n.property.name,r.isMemberExpression(n.object)?t(n.object,e):e=n.object.name+e}(t.callee,""):t.callee.name||""),n}function P(t,n){var e=t.match(n);return e?e.filter((function(t,n){return e.indexOf(t)===n})):[]}function F(t){var n=t.value,e=t.isExpression,o=void 0!==e&&e,i=t.key,a=t.insertOption,s=exports.option.namespace,c=n.trim(),l=c.replace(/'/g,'"').replace(/(\n)/g,"\\n"),u=i||J(l),p={option:exports.option,hash:u,value:c,uncodeValue:l,namespace:s};if(exports.option.translateExtends){var f=exports.option.translateExtends,g=f.handleCodeCall,h=f.handleCodeString;return o?g(p,a):h(p,a)}if(o){var d=r.stringLiteral(c);return d.extra={raw:"'".concat(l,"'"),rawValue:c},r.callExpression(r.identifier(exports.option.translateKey),[r.stringLiteral(u),d,r.stringLiteral(s)])}return"".concat(exports.option.translateKey,"('").concat(u,"','").concat(l,"','").concat(s,"')")}function J(t){for(var n=0,e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n|=0}return Math.abs(n).toString(36)+t.length.toString(36)}var I=function(t){return t.replace(/\\u[\dA-Fa-f]{4}/g,(function(t){return String.fromCharCode(parseInt(t.replace(/\\u/g,""),16))}))};function M(t,n){if(void 0===n&&(n=new WeakMap),"object"!=typeof t||null===t)return t;if(n.has(t))return n.get(t);if(t instanceof Date)return new Date(t);if(t instanceof RegExp)return new RegExp(t.source,t.flags);var e=Array.isArray(t)?[]:{};n.set(t,e);for(var o=0,r=d(d([],Object.keys(t),!0),Object.getOwnPropertySymbols(t).filter((function(n){return t.propertyIsEnumerable(n)})),!0);o<r.length;o++){var i=r[o];e[i]=M(t[i],n)}return e}var R=Object.freeze({__proto__:null,checkAgainstRegexArray:N,cloneDeep:M,createI18nTranslator:F,extractCnStrings:function(t){return P(t,/[^\x00-\xff]+/g)},extractFunctionName:K,extractStrings:P,generateId:J,getOriginRegex:A,hasOriginSymbols:C,removeComments:function(t){return t=(t=(t=t.replace(/\/\/.*?\n/g,"")).replace(/\/\*[\s\S]*?\*\//g,"")).replace(/<!--[\s\S]*?-->/g,"")},truncate:function(t){if(t.length<=20)return t;var n=t.length;return t.substring(0,10)+n+t.substring(n-10)},unicodeToString:I}),D=["$deepScan","console.info","console.warn","console.error","$i8n","console.log","$t","require","$$i8n","$$t","_createCommentVNode"],z={translateKey:"$t",excludedCall:[],excludedPattern:[/\.\w+$/],excludedPath:["node_modules"],includePath:[/src\//,/src\\/],globalPath:"./lang",distPath:"",distKey:"index",originLang:v.ZH,targetLangList:["en"],langKey:[],namespace:"lang",buildToDist:!1,translator:new O({proxyOption:{port:7890,host:"127.0.0.1",headers:{"User-Agent":"Node"}}}),translatorOption:void 0,translateType:x.FULL_AUTO,rewriteConfig:!0,commonTranslateKey:"",deepScan:!1,insertFileExtensions:[],translateExtends:null};exports.option=f({},z);var U=function(){var t=this;this.handleInitFile=function(n,e){return g(t,void 0,void 0,(function(){var t,o,a,s,c;return h(this,(function(l){switch(l.label){case 0:return t=n,o=!1,a=!1,s="Vue",[4,i.transformAsync(t,{configFile:!1,plugins:[{visitor:{ImportDeclaration:function(t){var n=t.node;if("vue"===n.source.value){o=!0;var e=n.specifiers;e.forEach((function(t){r.isImportDefaultSpecifier(t)&&(a=!0,s=t.local.name)})),a||(a=!0,e.unshift(r.importDefaultSpecifier(r.identifier("Vue"))))}}}}]})];case 1:return c=l.sent(),o&&c&&(t=c.code),o||(t="import Vue from 'vue'\n                                    ".concat(t)),[2,{path:e,importDefaultChar:s,source:t}]}}))}))},this.handleCodeCall=function(t,n){var e=t.option,o=t.hash,i=t.value,a=t.uncodeValue,s=t.namespace,c=r.stringLiteral(i);return c.extra={raw:"'".concat(a,"'"),rawValue:i},r.callExpression(r.memberExpression(r.memberExpression(r.identifier(n.importDefaultChar),r.identifier("prototype")),r.identifier(e.translateKey)),[r.stringLiteral(o),c,r.stringLiteral(s)])},this.handleCodeString=function(t,n){var e=t.option,o=t.hash,r=t.uncodeValue,i=t.namespace;return"".concat(n.importDefaultChar,".prototype.").concat(e.translateKey,"('").concat(o,"','").concat(r,"','").concat(i,"')")}},V={tab:{char:"\t",size:1},space:{char:" ",size:4}},$={type:"tab"},q=[],H=function(t){return"\\".concat(q.push(t),"\\")},B=function(t,n){return q[+n-1]},W=function(t,n){return new Array(t+1).join(n)};function Y(t,n){void 0===n&&(n=$);var e="string"==typeof t?t:JSON.stringify(t),o=V[n.type];if(!o)throw new Error('Unrecognized indent type: "'.concat(n.type,'"'));return function(t,n){q=[];var e="",o=0;t=t.replace(/\\./g,H).replace(/(".*?"|'.*?')/g,H).replace(/\s+/g,"");for(var r=0;r<t.length;r++){var i=t.charAt(r);switch(i){case"{":case"[":e+=i+"\n"+W(++o,n);break;case"}":case"]":e+="\n"+W(--o,n)+i;break;case",":e+=",\n"+W(o,n);break;case":":e+=": ";break;default:e+=i}}return e.replace(/\[[\d,\s]+?\]/g,(function(t){return t.replace(/\s/g,"")})).replace(/\\(\d+)\\/g,B).replace(/\\(\d+)\\/g,B)}(e,W(n.size||o.size,o.char))}function G(){var t=exports.option.translateKey,n=exports.option.namespace,e=exports.option.originLang,o=exports.option.targetLangList,r=exports.option.commonTranslateKey,i=d(d([],o,!0),[e],!1).map((function(t){return[t.replace("-",""),t]})).map((function(t){return"'".concat(t[0],"': (globalThis && globalThis.").concat(n," && globalThis.").concat(n,".").concat(t[0],") ? globalThis.").concat(n,".").concat(t[0]," : globalThis._getJSONKey('").concat(t[1],"', langJSON)")})).join(",\n"),c="\n    // 导入国际化JSON文件\n    import langJSON from './index.json'\n    (function () {\n    // 定义翻译函数\n    let ".concat(t," = function (key, val, nameSpace) {\n      // 获取指定命名空间下的语言包\n      const langPackage = ").concat(t,"[nameSpace];\n      // 返回翻译结果，如果不存在则返回默认值\n      return (langPackage || {})[key] || val;\n    };\n    // 定义简单翻译函数，直接返回传入的值\n    let $").concat(t," = function (val) {\n      return val;\n    };\n    globalThis.$deepScan = function (val) {\n      return val;\n    };\n    // 定义设置语言包的方法\n    ").concat(t,".locale = function (locale, nameSpace) {\n      // 将指定命名空间下的语言包设置为传入的locale\n      ").concat(t,"[nameSpace] = locale || {};\n    };\n    // 将翻译函数挂载到globalThis对象上，如果已经存在则使用已有的\n    globalThis.").concat(t," = globalThis.").concat(t," || ").concat(t,";\n    // 将简单翻译函数挂载到globalThis对象上\n    globalThis.$").concat(t," = $").concat(t,";\n    // 定义从JSON文件中获取指定键的语言对象的方法\n    globalThis._getJSONKey = function (key, insertJSONObj = undefined) {\n        // 获取JSON对象\n        const JSONObj = insertJSONObj;\n        // 初始化语言对象\n        const langObj = {};\n        // 遍历JSON对象的所有键\n        Object.keys(JSONObj).forEach((value) => {\n            // 将每个语言的对应键值添加到语言对象中\n            langObj[value] = JSONObj[value][key];\n        });\n        // 返回语言对象\n        return langObj;\n    };\n    })();\n    // 定义语言映射对象\n    const langMap = {\n        ").concat(i,"\n    };\n    // 存储语言是否存在\n    // 判断 globalThis.localStorage.getItem 是否为函数\n    const isFunction = (fn) => {\n        return typeof fn === 'function';\n    };\n    const withStorageLang = isFunction && globalThis && globalThis.localStorage && \n    isFunction(globalThis.localStorage.getItem) && globalThis.localStorage.getItem('").concat(n,"');\n    const withStorageCommonLang = isFunction && globalThis && globalThis.localStorage && \n    isFunction(globalThis.localStorage.getItem) && globalThis.localStorage.getItem('").concat(r,"');\n    // 从本地存储中获取通用语言，如果不存在则使用空字符串\n    const commonLang = withStorageCommonLang ? globalThis.localStorage.getItem('").concat(r,"') : '';\n    // 从本地存储中获取当前语言，如果不存在则使用源语言\n    const baseLang = withStorageLang ? globalThis.localStorage.getItem('").concat(n,"') : '").concat(e.replace("-",""),"';\n    const lang = commonLang ? commonLang : baseLang;\n    // 根据当前语言设置翻译函数的语言包\n    globalThis.").concat(t,".locale(langMap[lang], '").concat(n,"');\n  "),l=a.join(exports.option.globalPath,"index.js");if(!s.existsSync(l)||exports.option.rewriteConfig){var u=!0;if(s.existsSync(l))u=J(c)!==J(s.readFileSync(l,"utf-8"));u&&s.writeFileSync(l,c)}}function X(){var t=a.join(exports.option.globalPath,"index.json");s.existsSync(t)||s.writeFileSync(t,JSON.stringify({}))}function Z(){var t=a.join(exports.option.globalPath,"index.json");try{return s.readFileSync(t,"utf-8")}catch(t){return"ENOENT"===t.code?console.log("❌读取JSON配置文件异常，文件不存在"):console.log("❌读取JSON配置文件异常，无法读取文件"),JSON.stringify({})}}function Q(t,n){void 0===n&&(n=void 0);var e=n||JSON.parse(Z()),o={};return Object.keys(e).forEach((function(n){o[n]=e[n][t]})),o}function tt(t){var n=a.join(exports.option.globalPath,"index.json"),e=Y(t);s.existsSync(n)?s.writeFileSync(n,e):console.log("❌JSON配置文件写入异常，文件不存在")}var nt=Object.freeze({__proto__:null,buildSetLangConfigToIndexFile:function(){if(exports.option.buildToDist){var t={};exports.option.langKey.forEach((function(n){t[n]=Q(n)})),s.existsSync(exports.option.distPath)&&s.readdir(exports.option.distPath,(function(n,e){n?console.error("❌构建文件夹为空，翻译配置无法写入"):e.forEach((function(n){if(n.startsWith(exports.option.distKey)&&n.endsWith(".js")){var e=a.join(exports.option.distPath,n);s.readFile(e,"utf-8",(function(n,o){if(n)return console.log(e),void console.error("❌构建主文件不存在，翻译配置无法写入");var r="";Object.keys(t).forEach((function(n){r+="globalThis['".concat(exports.option.namespace,"']['").concat(n,"']=").concat(JSON.stringify(t[n]),";")}));try{s.writeFileSync(e,"globalThis['".concat(exports.option.namespace,"']={};").concat(r)+o),console.info("恭喜：翻译配置写入构建主文件成功🌟🌟🌟")}catch(n){console.error("翻译配置写入构建主文件失败:",n)}}))}}))}))}},getLangObjByJSONFileWithLangKey:Q,getLangTranslateJSONFile:Z,initLangFile:function(){s.existsSync(exports.option.globalPath)||s.mkdirSync(exports.option.globalPath),X(),G()},initLangTranslateJSONFile:X,initTranslateBasicFnFile:G,setLangTranslateJSONFile:tt}),et="\n┇┇┇\n",ot=/\n┇ *┇ *┇\n/,rt={};function it(t,n){rt[t]||(rt[t]=n)}function at(){return rt}function st(t,n,e){return g(this,void 0,void 0,(function(){var o,r,i,a;return h(this,(function(s){switch(s.label){case 0:return o={},Object.keys(t).forEach((function(e){n[e]||(o[e]=t[e])})),Object.values(o).length?(console.info("进入新增语言补全翻译..."),[4,ct(o,e)]):[2];case 1:if((r=s.sent()).length!==Object.values(t).length)return console.error("翻译异常，翻译结果缺失❌"),[2];i=r,console.info("翻译成功⭐️⭐️⭐️"),Object.keys(o).forEach((function(t,e){n[t]=i[e]})),console.log("开始写入JSON配置文件..."),a=JSON.parse(Z()),Object.keys(o).forEach((function(t){a[t][e]=n[t]}));try{tt(a),console.info("JSON配置文件写入成功⭐️⭐️⭐️")}catch(t){console.error("❌JSON配置文件写入失败"+t)}return console.info("新增语言翻译补全成功⭐️⭐️⭐️"),[2]}}))}))}function ct(t,n){return g(this,void 0,void 0,(function(){var e,o,r,i;return h(this,(function(a){switch(a.label){case 0:for(e=exports.option.translator,o=function(t,n){for(var e=et.length,o=[],r=[],i=0,a=function(){if(r.length>0){var t=r.join(et).length;t>n&&console.warn("缓冲区提交异常：生成块长度 ".concat(t," 超过限制")),o.push(r.join(et)),r=[],i=0}},s=0,c=t;s<c.length;s++){var l=c[s],u=l.length+(r.length>0?e:0);l.length>n?(r.length>0&&a(),l.length>1.5*n&&console.warn("超长文本告警：检测到长度 ".concat(l.length," 字符的文本项，可能影响翻译质量")),o.push(l)):(i+u>n&&a(),i+=u,r.push(l))}return a(),o}(Object.values(t),e.option.maxChunkSize),r=[],i=0;i<o.length;i++)r.push(e.translate(o[i],exports.option.originLang,n,et));return[4,Promise.all(r)];case 1:return[2,a.sent().map((function(t){var n=function(t,n){return t.split(n).map((function(t){return t.trim()}))};if(ot.test(t))return n(t,ot);var e=t.split("\n").find((function(t){return 3===t.length})),o=[];e&&(o=n(t,new RegExp("\\n".concat(e,"\\n"))));var r=o.filter(Boolean);return r.length>1?r:n(t,ot)})).flat()]}}))}))}var lt=Object.freeze({__proto__:null,SEPARATOR:et,SPLIT_SEPARATOR_REGEX:ot,autoTranslate:function(){return g(this,void 0,void 0,(function(){var t,n,e,o,r,i,a,s;return h(this,(function(c){switch(c.label){case 0:if(t={},exports.option.langKey.forEach((function(n){t[n]=Q(n)})),n=JSON.parse(JSON.stringify(at())),e={},Object.keys(n).forEach((function(o){t[exports.option.originLang][o]||(e[o]=n[o])})),0===Object.keys(e).length)return console.info("✅ 当前没有需要翻译的新内容"),[2];o={},r=0,c.label=1;case 1:return r<exports.option.langKey.length?(i=exports.option.langKey[r],0===r?(o[exports.option.originLang]=Object.values(e),[3,3]):(console.info("开始自动翻译..."),[4,ct(e,exports.option.langKey[r])])):[3,4];case 2:if((a=c.sent()).length!==Object.keys(e).length)return console.error("❌ 使用付费翻译时，请检查翻译API额度是否充足，或是否已申请对应翻译API使用权限"),console.error("❌ 翻译结果不完整\n                预期数量: ".concat(Object.keys(e).length,"\n                实际数量: ").concat(a.length,"\n                样例数据: ").concat(JSON.stringify(a.slice(0,3)))),[2];o[i]=a,console.info("✅ ".concat(i," 翻译完成")),c.label=3;case 3:return r++,[3,1];case 4:Object.keys(e).forEach((function(n,e){exports.option.langKey.forEach((function(r){t[r][n]=o[r][e]}))})),console.log("📄 构建配置文件数据结构..."),s={},Object.keys(t[exports.option.originLang]).forEach((function(n){s[n]={},exports.option.langKey.forEach((function(e){s[n][e]=t[e][n]}))}));try{tt(s),console.info("🎉 多语言配置文件已成功更新")}catch(t){console.error("❌ 配置文件写入失败，原因:",t)}return[2]}}))}))},completionTranslateAndWriteConfigFile:st,getLangObj:at,initLangObj:function(t){Object.keys(rt)||(rt=t)},get langObj(){return rt},languageConfigCompletion:function(t){var n=this;if(Object.keys(t)){var e=[],o=JSON.parse(Z());exports.option.targetLangList.forEach((function(t){var n=Q(t,o);e.push({key:t,curLangObj:n})})),e.forEach((function(e){return g(n,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return[4,st(t,e.curLangObj,e.key)];case 1:return n.sent(),[2]}}))}))}))}},setLangObj:it});function ut(t){var n=t.arguments||[],e=l.isStringLiteral(n[0])?n[0].value:"",o=l.isStringLiteral(n[1])?n[1].value:"";e&&o&&l.isStringLiteral(n[1])&&it(e,o)}function pt(t){return function(n){var e,o,r,i;if(exports.option.translateType!==x.SEMI_AUTO){var a,s=n.node,c=n.parent,u=s.value;if(["zh-cn","ja","ko"].some((function(t){return exports.option.originLang.includes(t)||exports.option.originLang===t})))try{u=I(u)}catch(t){console.log("转换异常")}if(C(u)&&exports.option.excludedPattern.length&&!N(u,d([],exports.option.excludedPattern,!0))){var p=K(c);if((null===(o=null===(e=null==c?void 0:c.callee)||void 0===e?void 0:e.property)||void 0===o?void 0:o.name)===exports.option.translateKey||l.isImportDeclaration(c)||c.key===s||l.isCallExpression(c)&&p&&(exports.option.excludedCall.includes(p)||(null===(r=null==p?void 0:p.split("."))||void 0===r?void 0:r.pop())&&exports.option.excludedCall.includes((null===(i=null==p?void 0:p.split("."))||void 0===i?void 0:i.pop())||"")))return;var f=void 0;if(exports.option.deepScan&&((a=u).includes("\n")||a.includes("\\")||a.includes("\r")||a.includes("\t")||a.includes("\v")||a.includes("\f")||a.includes(">")||a.includes("<")))f=function(t,n){var e=[],o=[];t.forEach((function(t,r){0===r?A().test(t)?(e.push(l.templateElement({raw:"",cooked:""},!1)),o.push(F({value:t,isExpression:!0,insertOption:n}))):e.push(l.templateElement({raw:t,cooked:t},!1)):A().test(t)?o.push(F({value:t,isExpression:!0,insertOption:n})):e.push(l.templateElement({raw:t,cooked:t},!1))})),e.length===o.length?e.push(l.templateElement({raw:"",cooked:""},!0)):e.length>o.length&&(e[e.length-1].tail=!0);var r=l.templateLiteral(e,o);return l.callExpression(l.identifier("$deepScan"),[r])}(function(t,n){for(var e=new RegExp("(".concat(n.source,"|").concat(/[，。？！《》,.．：!?""''；‘“、0-9]/.source,")"),n.flags),o=t.split(e).filter(Boolean),r=[],i="",a=new RegExp("(".concat(n.source,"|").concat(/[，。？！《》,.．：!?；‘“、0-9]/.source,")"),n.flags),s=0,c=o;s<c.length;s++){var l=c[s];a.test(l)?i+=l:(i&&(r.push(i),i=""),r.push(l))}i&&r.push(i);for(var u=[],p="",f=0;f<r.length;f++)l=r[f],n.test(l)?(p&&(u.push(p),p=""),u.push(l)):(p+=l,(f===r.length-1||n.test(r[f+1]))&&(u.push(p),p=""));return p&&u.push(p),u}(u,A()),t);else if(l.isJSXAttribute(c)){var g=F({insertOption:t,value:u,isExpression:!0});f=l.jSXExpressionContainer(g)}else f=F({insertOption:t,value:u,isExpression:!0});n.replaceWith(f)}}}}var ft=Object.freeze({__proto__:null,default:function(t){var n=pt(t),e=function(t){return function(n){if(console.log("jsx text"),exports.option.translateType!==x.SEMI_AUTO){var e=n.node.value;if(["zh-cn","ja","ko"].some((function(t){return exports.option.originLang.includes(t)||exports.option.originLang===t})))try{e=I(e)}catch(t){console.log("转换异常")}if(C(e)&&exports.option.excludedPattern.length&&!N(e,d([],exports.option.excludedPattern,!0))){var o=F({insertOption:t,value:e,isExpression:!0}),r=l.jSXExpressionContainer(o);n.replaceWith(r)}}}}(t),o=function(t){return function(n){var e,o;if(exports.option.translateType!==x.SEMI_AUTO){var i=n.node,a=n.parent;if(i.value){var s=i.value.raw||i.value.cooked;if(["zh-cn","ja","ko"].some((function(t){return exports.option.originLang.includes(t)||exports.option.originLang===t})))try{s=I(s)}catch(t){console.log("转换异常")}if(s&&C(s)&&exports.option.excludedPattern.length&&!N(s,d([],exports.option.excludedPattern,!0))){var c=K(a);if(r.isCallExpression(a)&&c&&(exports.option.excludedCall.includes(c)||(null===(e=null==c?void 0:c.split("."))||void 0===e?void 0:e.pop())&&exports.option.excludedCall.includes((null===(o=null==c?void 0:c.split("."))||void 0===o?void 0:o.pop())||"")))return;var l=F({insertOption:t,value:s});i.value.raw=i.value.cooked="${".concat(l,"}");var u=J(s);u&&s&&it(u,s)}}}}}(t),i=function(t){return function(n){var e,o=n.node,r=o.callee;if(r.name===exports.option.translateKey||r.property&&r.property.name===exports.option.translateKey)if(exports.option.translateType===x.SEMI_AUTO){var i=o.arguments||[];if(1===i.length){var a=(null===(e=i[0])||void 0===e?void 0:e.value)||"",s=F({insertOption:t,value:a,isExpression:!0});n.replaceWith(s),ut(s)}}else exports.option.translateType===x.FULL_AUTO&&(r.name===exports.option.translateKey||r.property&&r.property.name===exports.option.translateKey)&&ut(o)}}(t);return function(){return{visitor:{StringLiteral:n,JSXText:e,TemplateElement:o,CallExpression:i}}}}});exports.BaiduTranslator=T,exports.EmptyTranslator=E,exports.FunctionFactoryOption=k,exports.GoogleTranslator=O,exports.ScanTranslator=j,exports.Translator=m,exports.VolcengineTranslator=w,exports.Vue2Extends=U,exports.YoudaoTranslator=S,exports.baseUtils=R,exports.checkOption=function(){return exports.option.translateKey?exports.option.namespace?exports.option.buildToDist&&!exports.option.distKey?(console.log("❌请配置打包后生成文件的主文件名称"),!1):exports.option.buildToDist&&!exports.option.distPath?(console.log("❌请配置打包后生成文件的位置"),!1):exports.option.originLang?!(!exports.option.targetLangList||!exports.option.targetLangList.length)||(console.error("❌请配置目标翻译语言数组"),!1):(console.error("❌请配置来源语言"),!1):(console.error("❌请配置命名空间"),!1):(console.error("❌请配置翻译调用函数"),!1)},exports.fileUtils=nt,exports.filter=ft,exports.initOption=function(t){exports.option=f(f({},z),function(t){var n=M(t);return n.translator=null==t?void 0:t.translator,n.translator||(n.translator=n.translatorOption?new m(n.translatorOption):void 0),n.translator||delete n.translator,n}(t)),exports.option.langKey=d([exports.option.originLang],exports.option.targetLangList,!0),exports.option.excludedCall=d(d(d([],exports.option.excludedCall,!0),D,!0),[exports.option.translateKey,"$"+exports.option.translateKey],!1)},exports.translateUtils=lt;
//# sourceMappingURL=index.cjs.map
